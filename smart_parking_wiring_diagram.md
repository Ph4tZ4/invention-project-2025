# ระบบลานจอดรถอัจฉริยะ - แผนผังการต่อสาย

## ผังการต่อสายแบบภาพ

```
                    ESP32 Development Board
                   ┌─────────────────────────┐
                   │  ┌─────┐   ┌─────┐      │
                   │  │ USB │   │Reset│      │
                   │  └─────┘   └─────┘      │
                   │                         │
         GPIO4  ────┤ 4                   VIN├──── +5V Power (if needed)
         GPIO5  ────┤ 5                   GND├──── Ground Rail
         GPIO16 ────┤16                  3.3V├──── +3.3V Power Rail  
         GPIO17 ────┤17                    21├──── SDA (LCD)
         GPIO25 ────┤25                    22├──── SCL (LCD)
         GPIO26 ────┤26                    23├──── Blue LED
                   │                      18├──── Red LED  
                   │                      19├──── Green LED
                   │                         │
                   └─────────────────────────┘
```

## การเชื่อมต่ออุปกรณ์

### เซ็นเซอร์อินฟาเรด 6 ตัว (MH-Sensor-Series)
```
ช่องจอด A1 (หน้าซ้าย):
┌─────────────┐     ┌──────────┐
│ MH-Sensor A1│     │  ESP32   │
│             │     │          │
│ VCC ────────┼─────┤ 3.3V     │
│ GND ────────┼─────┤ GND      │  
│ OUT ────────┼─────┤ GPIO4    │
└─────────────┘     └──────────┘

ช่องจอด A2 (หน้าขวา):
┌─────────────┐     ┌──────────┐
│ MH-Sensor A2│     │  ESP32   │
│             │     │          │
│ VCC ────────┼─────┤ 3.3V     │
│ GND ────────┼─────┤ GND      │  
│ OUT ────────┼─────┤ GPIO5    │
└─────────────┘     └──────────┘

ช่องจอด B1 (กลางซ้าย):
┌─────────────┐     ┌──────────┐
│ MH-Sensor B1│     │  ESP32   │
│             │     │          │
│ VCC ────────┼─────┤ 3.3V     │
│ GND ────────┼─────┤ GND      │  
│ OUT ────────┼─────┤ GPIO16   │
└─────────────┘     └──────────┘

ช่องจอด B2 (กลางขวา):
┌─────────────┐     ┌──────────┐
│ MH-Sensor B2│     │  ESP32   │
│             │     │          │
│ VCC ────────┼─────┤ 3.3V     │
│ GND ────────┼─────┤ GND      │  
│ OUT ────────┼─────┤ GPIO17   │
└─────────────┘     └──────────┘

ช่องจอด C1 (หลังซ้าย):
┌─────────────┐     ┌──────────┐
│ MH-Sensor C1│     │  ESP32   │
│             │     │          │
│ VCC ────────┼─────┤ 3.3V     │
│ GND ────────┼─────┤ GND      │  
│ OUT ────────┼─────┤ GPIO25   │
└─────────────┘     └──────────┘

ช่องจอด C2 (หลังขวา):
┌─────────────┐     ┌──────────┐
│ MH-Sensor C2│     │  ESP32   │
│             │     │          │
│ VCC ────────┼─────┤ 3.3V     │
│ GND ────────┼─────┤ GND      │  
│ OUT ────────┼─────┤ GPIO26   │
└─────────────┘     └──────────┘
```

### ไฟแสดงสถานะ LED
```
LED สีแดง (แจ้งเตือนลานจอดเต็ม):
┌─────────────┐     ┌──────────┐     ┌─────────┐
│   LED แดง   │     │  220Ω    │     │  ESP32  │
│             │     │ตัวต้านทาน │     │         │
│ Anode (+) ──┼─────┤   ───    ├─────┤ GPIO18  │
│ Cathode(-)──┼─────────────────────┤ GND     │
└─────────────┘     └──────────┘     └─────────┘

LED สีเขียว (มีช่องว่าง):
┌─────────────┐     ┌──────────┐     ┌─────────┐
│  LED เขียว  │     │  220Ω    │     │  ESP32  │
│             │     │ตัวต้านทาน │     │         │
│ Anode (+) ──┼─────┤   ───    ├─────┤ GPIO19  │
│ Cathode(-)──┼─────────────────────┤ GND     │
└─────────────┘     └──────────┘     └─────────┘

LED สีฟ้า (สถานะระบบ):
┌─────────────┐     ┌──────────┐     ┌─────────┐
│   LED ฟ้า   │     │  220Ω    │     │  ESP32  │
│             │     │ตัวต้านทาน │     │         │
│ Anode (+) ──┼─────┤   ───    ├─────┤ GPIO23  │
│ Cathode(-)──┼─────────────────────┤ GND     │
└─────────────┘     └──────────┘     └─────────┘
```

### จอแสดงผล LCD 16x2 I2C
```
┌─────────────────┐     ┌──────────┐
│   LCD 16x2 I2C  │     │  ESP32   │
│                 │     │          │
│ VCC ────────────┼─────┤ 3.3V     │
│ GND ────────────┼─────┤ GND      │
│ SDA ────────────┼─────┤ GPIO21   │
│ SCL ────────────┼─────┤ GPIO22   │
└─────────────────┘     └──────────┘
```

## ผังลานจอดรถจริง

```
    ┌─── ทางเข้า/ออก ───┐
    │                     │
    │  🚗    🚗           │  ← แถวหน้า
    │ [A1]  [A2]          │
    │                     │
    │  🚗    🚗           │  ← แถวกลาง  
    │ [B1]  [B2]          │
    │                     │
    │  🚗    🚗           │  ← แถวหลัง
    │ [C1]  [C2]          │
    │                     │
    └─────────────────────┘

คำอธิบาย:
🚗 = ช่องจอดรถที่มีเซ็นเซอร์อินฟาเรด
[XX] = รหัสช่องจอด (A1, A2, B1, B2, C1, C2)
```

## ตัวอย่างการจัดวาง Breadboard

```
                        Breadboard
    ┌─────────────────────────────────────────┐
    │ + + + + + + + + + + + + + + + + + + + + │ ← ราง +3.3V
    │ - - - - - - - - - - - - - - - - - - - - │ ← ราง GND
    │                                         │
    │  [LED แดง]   [220Ω]  →  GPIO18         │
    │  [LED เขียว] [220Ω]  →  GPIO19         │  
    │  [LED ฟ้า]   [220Ω]  →  GPIO23         │
    │                                         │
    │  เซ็นเซอร์ A1  →  GPIO4                 │
    │  เซ็นเซอร์ A2  →  GPIO5                 │
    │  เซ็นเซอร์ B1  →  GPIO16                │
    │  เซ็นเซอร์ B2  →  GPIO17                │
    │  เซ็นเซอร์ C1  →  GPIO25                │
    │  เซ็นเซอร์ C2  →  GPIO26                │
    │                                         │
    │  LCD SDA    →  GPIO21                  │
    │  LCD SCL    →  GPIO22                  │
    │                                         │
    └─────────────────────────────────────────┘
```

## ความต้องการด้านไฟฟ้า

- **ESP32**: 3.3V (ผ่าน USB หรือแหล่งจ่ายไฟภายนอก)
- **เซ็นเซอร์ MH**: 3.3V หรือ 5V (ตรวจสอบข้อมูลจำเพาะของเซ็นเซอร์)
- **LED**: 3.3V พร้อมตัวต้านทานจำกัดกระแส 220Ω
- **LCD I2C**: 3.3V หรือ 5V (โมดูลส่วนใหญ่ตรวจจับอัตโนมัติ)

**การใช้กระแสรวม**: ~200-300mA (ขึ้นอยู่กับจำนวนอุปกรณ์ที่ใช้งาน)

## ตารางสรุปการเชื่อมต่อ

| อุปกรณ์ | ขา/การเชื่อมต่อ | ESP32 GPIO | หมายเหตุ |
|---------|----------------|------------|----------|
| เซ็นเซอร์ A1 | OUT | GPIO4 | ช่องจอดหน้าซ้าย |
| เซ็นเซอร์ A2 | OUT | GPIO5 | ช่องจอดหน้าขวา |
| เซ็นเซอร์ B1 | OUT | GPIO16 | ช่องจอดกลางซ้าย |
| เซ็นเซอร์ B2 | OUT | GPIO17 | ช่องจอดกลางขวา |
| เซ็นเซอร์ C1 | OUT | GPIO25 | ช่องจอดหลังซ้าย |
| เซ็นเซอร์ C2 | OUT | GPIO26 | ช่องจอดหลังขวา |
| LED แดง | Anode (+) | GPIO18 | ผ่านตัวต้านทาน 220Ω |
| LED เขียว | Anode (+) | GPIO19 | ผ่านตัวต้านทาน 220Ω |
| LED ฟ้า | Anode (+) | GPIO23 | ผ่านตัวต้านทาน 220Ω |
| LCD I2C | SDA | GPIO21 | สาย Data ของ I2C |
| LCD I2C | SCL | GPIO22 | สาย Clock ของ I2C |
| เซ็นเซอร์ทั้งหมด | VCC | 3.3V | แหล่งจ่ายไฟ |
| เซ็นเซอร์ทั้งหมด | GND | GND | กราวด์ร่วม |
| LED ทั้งหมด | Cathode (-) | GND | กราวด์ร่วม |
| LCD I2C | VCC | 3.3V | แหล่งจ่ายไฟ |
| LCD I2C | GND | GND | กราวด์ร่วม |

## เคล็ดลับการติดตั้ง

1. **การวางเซ็นเซอร์**: ติดตั้งเซ็นเซอร์ที่ความสูงที่เหมาะสม (10-30cm เหนือพื้น) เพื่อตรวจจับรถยนต์ได้อย่างน่าเชื่อถือ
2. **การจัดการสายเคเบิล**: ใช้การจัดการสายเคเบิลที่เหมาะสมเพื่อหลีกเลี่ยงการรบกวน
3. **การกระจายไฟ**: ใช้โมดูลจ่ายไฟ breadboard เพื่อกระจายไฟที่สะอาด
4. **การทดสอบ**: ทดสอบเซ็นเซอร์แต่ละตัวแยกก่อนเชื่อมต่อทั้ง 6 ตัว
5. **การปรับเทียบ**: ปรับความไวของเซ็นเซอร์โดยใช้ตัวปรับที่เซ็นเซอร์
6. **การป้องกันสภาพอากาศ**: ใช้ตู้กันน้ำสำหรับการติดตั้งกลางแจ้ง

## การแก้ไขปัญหา

- **เซ็นเซอร์ไม่ตรวจจับ**: ตรวจสอบการเชื่อมต่อไฟและการปรับความไวเซ็นเซอร์
- **LCD ไม่แสดงผล**: ตรวจสอบที่อยู่ I2C (ลอง 0x27 หรือ 0x3F) และการเชื่อมต่อ
- **LED ไม่ทำงาน**: ตรวจสอบค่าตัวต้านทานและการกำหนด GPIO pin
- **การอ่านค่าไม่สม่ำเสมอ**: ตรวจสอบแหล่งจ่ายไฟที่เสถียรและการต่อกราวด์ที่เหมาะสม
